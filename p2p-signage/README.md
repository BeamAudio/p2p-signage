# P2P Signage Protocol Analysis Script

This directory contains `log_parser.py`, a Python script designed to analyze and visualize the network traffic generated by the Dart-based P2P signage application.

## Features

- **Log Parsing:** Parses `[UDP_LOG]` entries from the Dart application's output.
- **Message Type Identification:** Extracts message types (e.g., `ack`, `gossip`, `auth`) from JSON payloads.
- **Wireshark-like Table:** Displays detailed UDP packet information in a tabular format, including relative timestamps, source/destination, protocol, message type, and a preview of the message content.
- **Packet Statistics:** Provides a summary of total, incoming, and outgoing packets.
- **Textual Time Plot:** Visualizes packet activity over time in a simple ASCII art timeline.
- **ASCII Sequence Diagram:** Generates a textual sequence diagram illustrating message exchanges between participants.
- **ASCII Activity Flow:** Shows a linear, textual representation of the sequence of message types.
- **ASCII State Flow:** For each unique participant, generates a simplified textual trace of inferred state changes based on message types and events.

## Usage

To use the script, you need a log file generated by the Dart P2P application (e.g., `multi_isolate_log.txt`).

```bash
python log_parser.py <path_to_log_file>
```

**Example:**

Assuming you are in the project root directory (`AccioTv`):

```bash
python p2p-signage/log_parser.py p2p-signage/p2p_signage_dart/multi_isolate_log.txt
```

### Output Explanation

The script will output several sections:

1.  **Wireshark-like Table:** A detailed list of all parsed UDP packets.
2.  **Packet Statistics:** A summary of the total number of packets, and how many were incoming versus outgoing.
3.  **Time Plot (Relative Seconds):** A timeline showing when different types of messages occurred.
4.  **ASCII Sequence Diagram:** A visual representation of who sent what message to whom.
5.  **ASCII Activity Flow:** A sequential list of all message events.
6.  **ASCII State Flow (per participant):** For each unique IP:Port, a trace of its inferred state changes based on the messages it sent or received.

## Development Notes

- The script relies on the `[UDP_LOG]` format emitted by the Dart application. Any changes to the Dart logging format may require updates to the regular expressions in `log_parser.py`.
- The ASCII art diagrams are simplified representations and may become less readable with a very large number of participants or complex interactions.
